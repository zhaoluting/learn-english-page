import{_ as O,d as G,r as B,br as J,f,o as r,c as d,S as R,h as o,x as i,i as u,H as q,I,g as l,e as L,w as c,R as b,p as T,q as N,a7 as $,y as W,z as D,k as V,j as K,u as U,D as S,N as X}from"./index-62c15d61.js";import{a as Y,f as j,d as Z,q as C,g as ss,v as es,L as os,W as ns}from"./index-a69beedb.js";import{s as P}from"./aalist-8410f228.js";import"./NoteItem-c259d461.js";const ts=G({name:"SummaryCover",components:{},props:{showCover:{type:Boolean,default:!0},showAnime:{type:Boolean,default:!0},songs:{type:Array}},setup(e,{emit:g}){const m=B({fullWords:[],textSlideUp:!1,songSlideUp:[],isShort:!0});s();function z(){m.textSlideUp?(m.textSlideUp=!1,m.songSlideUp=[]):(m.textSlideUp=!0,e.songs.map((n,p)=>(setTimeout(()=>{m.songSlideUp[p]=!0},p*50),n)))}function s(){!e.songs||e.songs.length==0||Promise.all(e.songs.map(n=>Y(n.lrcName))).then(n=>{const p=n.map((v,y)=>{const t=v.lyrics.map(_=>_.remarkIdx);return[].concat(...t)});console.log(e.songs);let w=[].concat(...p).map(v=>v?v.toLowerCase():"");w=Array.from(new Set(w)),m.fullWords=w.sort()})}return{...J(m),getSongAssets:j,downloadImage:Z,showSummary:z}}}),M=e=>(W("data-v-c6d5a7d9"),e=e(),D(),e),as={class:"summary-page"},is={class:"date"},ls={class:"summary-text"},rs={class:"big"},us={class:"number"},ds={class:"number"},cs={key:0},ms={class:"detail"},ps=M(()=>o("br",null,null,-1)),gs={class:"singer"},vs={key:1},_s={key:2,class:"summary-warp"},hs={class:"date"},fs={class:"summary-text"},ws={class:"big"},ys={class:"number"},zs={class:"number"},Ss={class:"song-item"},ks={class:"detail"},Cs=M(()=>o("br",null,null,-1)),qs={class:"singer"};function Is(e,g,m,z,s,n){const p=f("van-image"),w=f("van-col"),v=f("van-row"),y=f("van-button");return r(),d("div",as,[e.showCover?(r(),d("div",{key:0,id:"summaryPoster",class:R(["summary-warp poster",{"short-poster":e.isShort}])},[o("span",is,i(e.songs[0]&&e.songs[0].dateRange),1),o("div",ls,[o("p",rs,[u("盘点"),o("span",us,i(e.songs.length),1),u("首"+i(e.songs[0]&&e.songs[0].title),1)]),o("p",null,[u("顺带学习了"),o("span",ds,i(e.fullWords.length),1),u("个单词/短语")])]),e.isShort?(r(),L(v,{key:1},{default:c(()=>[(r(!0),d(q,null,I(e.songs,t=>(r(),L(w,{key:t.data,span:"8",class:"song-item"},{default:c(()=>[l(p,{class:"poster",width:"1.8rem",height:"1.8rem",fit:"cover",src:e.getSongAssets(t.posterName)},null,8,["src"])]),_:2},1024))),128))]),_:1})):(r(),d("div",cs,[(r(!0),d(q,null,I(e.songs,t=>(r(),d("div",{key:t.data,class:"song-item"},[l(p,{class:"poster",width:"1.3rem",height:"1.3rem",fit:"cover",src:e.getSongAssets(t.posterName)},null,8,["src"]),o("div",ms,[o("span",null,i(t.song),1),ps,o("span",gs,i(t.singer),1)])]))),128))]))],2)):b("",!0),e.showCover?(r(),d("div",vs,[l(y,{plain:"",size:"small",onClick:g[0]||(g[0]=t=>e.isShort=!e.isShort)},{default:c(()=>[u("切换封面")]),_:1}),l(y,{plain:"",size:"small",onClick:g[1]||(g[1]=t=>e.downloadImage("summaryPoster",e.songs[e.songs.length-1].date))},{default:c(()=>[u("下载封面")]),_:1}),l(y,{plain:"",size:"small",onClick:e.showSummary},{default:c(()=>[u("展示")]),_:1},8,["onClick"])])):b("",!0),e.showAnime?(r(),d("div",_s,[o("span",hs,i(e.songs[0]&&e.songs[0].dateRange),1),l($,{name:"van-slide-up"},{default:c(()=>[T(o("div",fs,[o("p",ws,[u("盘点"),o("span",ys,i(e.songs.length),1),u("首"+i(e.songs[0]&&e.songs[0].title),1)]),o("p",null,[u("顺带学习了"),o("span",zs,i(e.fullWords.length),1),u("个单词/短语")])],512),[[N,e.textSlideUp]])]),_:1}),(r(!0),d(q,null,I(e.songs,(t,_)=>(r(),d("div",{key:t.data},[l($,{name:"van-slide-up"},{default:c(()=>[T(o("div",Ss,[l(p,{class:"poster",width:"1.8rem",height:"1.8rem",fit:"cover",src:e.getSongAssets(t.posterName)},null,8,["src"]),o("div",ks,[o("span",null,i(t.song),1),Cs,o("span",qs,i(t.singer),1)])],512),[[N,e.songSlideUp[_]]])]),_:2},1024)]))),128))])):b("",!0)])}const A=O(ts,[["render",Is],["__scopeId","data-v-c6d5a7d9"]]);const Q=e=>(W("data-v-1031781b"),e=e(),D(),e),bs={class:"song-quiz"},Ts={class:"quiz-desc"},Ns=Q(()=>o("br",null,null,-1)),$s=Q(()=>o("br",null,null,-1)),Vs={class:"opt-btns"},Ps={class:"content-warp"},Ls=["src"],Qs={class:"video-warp"},Us=Q(()=>o("div",{class:"mosaic"},null,-1)),As={__name:"quiz",setup(e){const g=V(),m=V(),z=V(),s=B({quizNum:20240526,showPicker:!1,quizOptions:[],songs:[],nowIdx:0,showVideo:!1,showQuizCover:!0,coverImg:null,isQuiz:!0}),n=K(()=>s.songs[s.nowIdx]||null);function p(){if(s.quizOptions.length==0){const a=Object.keys(C);s.quizOptions=a.map(k=>({text:k,value:k})),s.quizNum=a[a.length-1]}const _=C[s.quizNum].list;s.songs=_.map(a=>({dateRange:C[s.quizNum].dateRange,title:C[s.quizNum].title,...a,...P[a.songIdx],videoOptions:ss(P[a.songIdx],{currentTime:(a.quiz_lyrics[0].time+P[a.songIdx].lyricDelyTime-500)/1e3})})),console.log(s.songs)}function w(){s.showQuizCover=!0,z.value.showSummary(),setTimeout(()=>{s.showQuizCover=!1,v()},1500)}function v(){if(s.showVideo=!1,s.coverImg=null,s.nowIdx>=s.songs.length){s.showQuizCover=!0;return}s.coverImg=j(`${n.value.lrcName} (2).png`),n.value.quiz_type?(setTimeout(()=>{s.coverImg=null,s.showVideo=!0,s.isQuiz=!0,S(()=>{g.value.play()})},1e3),setTimeout(()=>{s.showVideo=!1,s.isQuiz=!1},1e3+n.value.last_time),setTimeout(()=>{s.showVideo=!0,S(()=>{g.value.play()})},1e3+10+n.value.last_time),setTimeout(()=>{s.showVideo=!1,s.nowIdx++,S(()=>{v()})},1e3+10+n.value.last_time*2)):(setTimeout(()=>{s.coverImg=null,s.showVideo=!0,s.isQuiz=!1,S(()=>{g.value.play()})},1e3),setTimeout(()=>{s.showVideo=!1,s.nowIdx++,S(()=>{v()})},1e3+10+n.value.last_time))}function y(){m.value.play(n.value.quiz_lyrics[0].time)}function t({selectedOptions:_}){s.showPicker=!1,s.quizNum=_[0].text,p()}return p(),(_,a)=>{const k=f("van-field"),x=f("van-button"),E=f("van-picker"),F=f("van-popup");return r(),d("div",bs,[o("div",Ts,[u(" 【盘点】"+i(s.songs.length)+"首"+i(s.songs[0]&&s.songs[0].title),1),Ns,(r(!0),d(q,null,I(s.songs,(h,H)=>(r(),d("span",{key:h.song},[u(i(H+1)+".《"+i(h.song)+"》-"+i(h.singer),1),$s]))),128)),u(" #英语 #音乐 #学习 ")]),l(A,{showCover:!0,showAnime:!1,songs:s.songs},null,8,["songs"]),o("div",Vs,[l(k,{modelValue:s.quizNum,"onUpdate:modelValue":a[0]||(a[0]=h=>s.quizNum=h),onClick:a[1]||(a[1]=h=>s.showPicker=!0),"label-width":"50px",readonly:"",label:"日期",style:{width:"45%",float:"right","margin-top":"-10px"}},null,8,["modelValue"]),l(x,{plain:"",size:"small",onClick:w},{default:c(()=>[u("开始")]),_:1}),u(" "+i(s.nowIdx),1)]),l(F,{show:s.showPicker,"onUpdate:show":a[3]||(a[3]=h=>s.showPicker=h),round:"",position:"bottom"},{default:c(()=>[l(E,{value:[s.quizNum],columns:s.quizOptions,onCancel:a[2]||(a[2]=h=>s.showPicker=!1),onConfirm:t},null,8,["value","columns"])]),_:1},8,["show"]),l(U(ns),{content:"赶紧学英语呀",color:"#ffffff1a",fontSize:12},{default:c(()=>[o("div",Ps,[l($,{name:"van-fade"},{default:c(()=>[T(l(A,{ref_key:"quizCover",ref:z,showCover:!1,showAnime:!0,songs:s.songs},null,8,["songs"]),[[N,s.showQuizCover]])]),_:1}),l($,{name:"van-fade"},{default:c(()=>[T(o("img",{class:"summary-cover",src:s.coverImg},null,8,Ls),[[N,s.coverImg]])]),_:1}),n.value&&s.showVideo?(r(),d("div",{key:0,class:R(["record-warp",n.value.className])},[o("div",Qs,[(r(),L(U(es),X({key:s.nowIdx+"_"+s.isQuiz?1:0},n.value.videoOptions,{ref_key:"mvVideo",ref:g,onPlay:y,onPause:y}),null,16)),Us,l(os,{ref_key:"lyricListShow",ref:m,mode:s.isQuiz?"quiz":"",lrc:n.value.quiz_lyrics,detail:n.value},null,8,["mode","lrc","detail"])])],2)):b("",!0)])]),_:1})])}}},Ds=O(As,[["__scopeId","data-v-1031781b"]]);export{Ds as default};
