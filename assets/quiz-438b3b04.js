import{_ as A,d as x,r as O,br as G,f,o as r,c as d,S as B,h as o,x as i,i as u,H as q,I,g as l,e as L,w as c,R as b,p as T,q as N,a7 as V,y as R,z as W,k as $,j as J,u as Q,D as S,N as K}from"./index-66c524b0.js";import{a as X,f as D,d as Y,q as C,g as Z,v as ss,L as es,W as os}from"./index-1e884426.js";import{s as P}from"./aalist-1ba4c056.js";import"./NoteItem-12cdd645.js";const ns=x({name:"SummaryCover",components:{},props:{showCover:{type:Boolean,default:!0},showAnime:{type:Boolean,default:!0},songs:{type:Array}},setup(e,{emit:g}){const m=O({fullWords:[],textSlideUp:!1,songSlideUp:[],isShort:!0});s();function z(){m.textSlideUp?(m.textSlideUp=!1,m.songSlideUp=[]):(m.textSlideUp=!0,e.songs.map((n,p)=>(setTimeout(()=>{m.songSlideUp[p]=!0},p*50),n)))}function s(){!e.songs||e.songs.length==0||Promise.all(e.songs.map(n=>X(n.lrcName))).then(n=>{const p=n.map((v,y)=>{const t=v.lyrics.map(_=>_.remarkIdx);return[].concat(...t)});console.log(e.songs);let w=[].concat(...p).map(v=>v?v.toLowerCase():"");w=Array.from(new Set(w)),m.fullWords=w.sort()})}return{...G(m),getSongAssets:D,downloadImage:Y,showSummary:z}}}),j=e=>(R("data-v-c6d5a7d9"),e=e(),W(),e),ts={class:"summary-page"},as={class:"date"},is={class:"summary-text"},ls={class:"big"},rs={class:"number"},us={class:"number"},ds={key:0},cs={class:"detail"},ms=j(()=>o("br",null,null,-1)),ps={class:"singer"},gs={key:1},vs={key:2,class:"summary-warp"},_s={class:"date"},hs={class:"summary-text"},fs={class:"big"},ws={class:"number"},ys={class:"number"},zs={class:"song-item"},Ss={class:"detail"},ks=j(()=>o("br",null,null,-1)),Cs={class:"singer"};function qs(e,g,m,z,s,n){const p=f("van-image"),w=f("van-col"),v=f("van-row"),y=f("van-button");return r(),d("div",ts,[e.showCover?(r(),d("div",{key:0,id:"summaryPoster",class:B(["summary-warp poster",{"short-poster":e.isShort}])},[o("span",as,i(e.songs[0]&&e.songs[0].dateRange),1),o("div",is,[o("p",ls,[u("盘点"),o("span",rs,i(e.songs.length),1),u("首"+i(e.songs[0]&&e.songs[0].title),1)]),o("p",null,[u("顺带学习了"),o("span",us,i(e.fullWords.length),1),u("个单词/短语")])]),e.isShort?(r(),L(v,{key:1},{default:c(()=>[(r(!0),d(q,null,I(e.songs,t=>(r(),L(w,{key:t.data,span:"8",class:"song-item"},{default:c(()=>[l(p,{class:"poster",width:"1.8rem",height:"1.8rem",fit:"cover",src:e.getSongAssets(t.posterName)},null,8,["src"])]),_:2},1024))),128))]),_:1})):(r(),d("div",ds,[(r(!0),d(q,null,I(e.songs,t=>(r(),d("div",{key:t.data,class:"song-item"},[l(p,{class:"poster",width:"1.3rem",height:"1.3rem",fit:"cover",src:e.getSongAssets(t.posterName)},null,8,["src"]),o("div",cs,[o("span",null,i(t.song),1),ms,o("span",ps,i(t.singer),1)])]))),128))]))],2)):b("",!0),e.showCover?(r(),d("div",gs,[l(y,{plain:"",size:"small",onClick:g[0]||(g[0]=t=>e.isShort=!e.isShort)},{default:c(()=>[u("切换封面")]),_:1}),l(y,{plain:"",size:"small",onClick:g[1]||(g[1]=t=>e.downloadImage("summaryPoster",e.songs[e.songs.length-1].date))},{default:c(()=>[u("下载封面")]),_:1}),l(y,{plain:"",size:"small",onClick:e.showSummary},{default:c(()=>[u("展示")]),_:1},8,["onClick"])])):b("",!0),e.showAnime?(r(),d("div",vs,[o("span",_s,i(e.songs[0]&&e.songs[0].dateRange),1),l(V,{name:"van-slide-up"},{default:c(()=>[T(o("div",hs,[o("p",fs,[u("盘点"),o("span",ws,i(e.songs.length),1),u("首"+i(e.songs[0]&&e.songs[0].title),1)]),o("p",null,[u("顺带学习了"),o("span",ys,i(e.fullWords.length),1),u("个单词/短语")])],512),[[N,e.textSlideUp]])]),_:1}),(r(!0),d(q,null,I(e.songs,(t,_)=>(r(),d("div",{key:t.data},[l(V,{name:"van-slide-up"},{default:c(()=>[T(o("div",zs,[l(p,{class:"poster",width:"1.8rem",height:"1.8rem",fit:"cover",src:e.getSongAssets(t.posterName)},null,8,["src"]),o("div",Ss,[o("span",null,i(t.song),1),ks,o("span",Cs,i(t.singer),1)])],512),[[N,e.songSlideUp[_]]])]),_:2},1024)]))),128))])):b("",!0)])}const U=A(ns,[["render",qs],["__scopeId","data-v-c6d5a7d9"]]);const Is=e=>(R("data-v-debd0491"),e=e(),W(),e),bs={class:"song-quiz"},Ts={class:"quiz-desc"},Ns={class:"opt-btns"},Vs={class:"content-warp"},$s=["src"],Ps={class:"video-warp"},Ls=Is(()=>o("div",{class:"mosaic"},null,-1)),Qs={__name:"quiz",setup(e){const g=$(),m=$(),z=$(),s=O({quizNum:20240519,showPicker:!1,quizOptions:[],songs:[],nowIdx:0,showVideo:!1,showQuizCover:!0,coverImg:null,isQuiz:!0}),n=J(()=>s.songs[s.nowIdx]||null);function p(){if(s.quizOptions.length==0){const a=Object.keys(C);s.quizOptions=a.map(k=>({text:k,value:k})),s.quizNum=a[a.length-2]}const _=C[s.quizNum].list;s.songs=_.map(a=>({dateRange:C[s.quizNum].dateRange,title:C[s.quizNum].title,...a,...P[a.songIdx],videoOptions:Z(P[a.songIdx],{currentTime:(a.quiz_lyrics[0].time+P[a.songIdx].lyricDelyTime)/1e3})})),console.log(s.songs)}function w(){s.showQuizCover=!0,z.value.showSummary(),setTimeout(()=>{s.showQuizCover=!1,v()},1500)}function v(){if(s.showVideo=!1,s.coverImg=null,s.nowIdx>=s.songs.length){s.showQuizCover=!0;return}s.coverImg=D(`${n.value.lrcName} (2).png`),n.value.quiz_type?(setTimeout(()=>{s.coverImg=null,s.showVideo=!0,s.isQuiz=!0,S(()=>{g.value.play()})},800),setTimeout(()=>{s.showVideo=!1,s.isQuiz=!1},800+n.value.last_time),setTimeout(()=>{s.showVideo=!0,S(()=>{g.value.play()})},800+10+n.value.last_time),setTimeout(()=>{s.showVideo=!1,s.nowIdx++,S(()=>{v()})},800+10+n.value.last_time*2)):(setTimeout(()=>{s.coverImg=null,s.showVideo=!0,s.isQuiz=!1,S(()=>{g.value.play()})},800),setTimeout(()=>{s.showVideo=!1,s.nowIdx++,S(()=>{v()})},800+10+n.value.last_time))}function y(){m.value.play(n.value.quiz_lyrics[0].time)}function t({selectedOptions:_}){s.showPicker=!1,s.quizNum=_[0].text,p()}return p(),(_,a)=>{const k=f("van-field"),M=f("van-button"),E=f("van-picker"),F=f("van-popup");return r(),d("div",bs,[o("div",Ts,[u(" 【盘点】"+i(s.songs.length)+"首"+i(s.songs[0]&&s.songs[0].title)+" ",1),(r(!0),d(q,null,I(s.songs,(h,H)=>(r(),d("p",{key:h.song},i(H+1)+".《"+i(h.song)+"》-"+i(h.singer),1))),128))]),l(U,{showCover:!0,showAnime:!1,songs:s.songs},null,8,["songs"]),o("div",Ns,[l(k,{modelValue:s.quizNum,"onUpdate:modelValue":a[0]||(a[0]=h=>s.quizNum=h),onClick:a[1]||(a[1]=h=>s.showPicker=!0),"label-width":"50px",readonly:"",label:"日期",style:{width:"45%",float:"right"}},null,8,["modelValue"]),l(M,{plain:"",size:"small",onClick:w},{default:c(()=>[u("开始")]),_:1}),u(" "+i(s.nowIdx),1)]),l(F,{show:s.showPicker,"onUpdate:show":a[3]||(a[3]=h=>s.showPicker=h),round:"",position:"bottom"},{default:c(()=>[l(E,{value:[s.quizNum],columns:s.quizOptions,onCancel:a[2]||(a[2]=h=>s.showPicker=!1),onConfirm:t},null,8,["value","columns"])]),_:1},8,["show"]),l(Q(os),{content:"赶紧学英语呀",color:"#ffffff1a",fontSize:12},{default:c(()=>[o("div",Vs,[l(V,{name:"van-fade"},{default:c(()=>[T(l(U,{ref_key:"quizCover",ref:z,showCover:!1,showAnime:!0,songs:s.songs},null,8,["songs"]),[[N,s.showQuizCover]])]),_:1}),l(V,{name:"van-fade"},{default:c(()=>[T(o("img",{class:"summary-cover",src:s.coverImg},null,8,$s),[[N,s.coverImg]])]),_:1}),n.value&&s.showVideo?(r(),d("div",{key:0,class:B(["record-warp",n.value.className])},[o("div",Ps,[(r(),L(Q(ss),K({key:s.nowIdx+"_"+s.isQuiz?1:0},n.value.videoOptions,{ref_key:"mvVideo",ref:g,onPlay:y,onPause:y}),null,16)),Ls,l(es,{ref_key:"lyricListShow",ref:m,mode:s.isQuiz?"quiz":"",lrc:n.value.quiz_lyrics,detail:n.value},null,8,["mode","lrc","detail"])])],2)):b("",!0)])]),_:1})])}}},Rs=A(Qs,[["__scopeId","data-v-debd0491"]]);export{Rs as default};
